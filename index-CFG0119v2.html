<!doctype html>
<html lang="zh-TW">
  <head>
    <!-- ===== åŸºæœ¬è¨­å®š ===== -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ===== ç¶²ç«™èº«åˆ†è­˜åˆ¥ (ç¬¦åˆ GSB å®‰å…¨è¦ç¯„) ===== -->
    <meta
      name="description"
      content="DCCSèªçŸ¥å½ˆæ€§è¨“ç·´æ¨¡çµ„æ˜¯ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»çš„å­¸è¡“ç ”ç©¶å·¥å…·ï¼Œå°ˆç‚ºè½éšœå­¸ç”Ÿè¨­è¨ˆã€‚æ¡ç”¨çœ¼ç›èˆ‡å˜´å·´ä½œç‚ºåˆºæ¿€ç‰©ï¼Œç¬¦åˆè½éšœå­¸ç”Ÿè¦–è¦ºå­¸ç¿’ç‰¹æ€§ã€‚ä¸æ”¶é›†ä»»ä½•å€‹äººè³‡è¨Šï¼Œæ‰€æœ‰è³‡æ–™åƒ…åœ¨ç€è¦½å™¨æœ¬åœ°è™•ç†ã€‚"
    />
    <meta name="author" content="ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»ç¢©å£«ç­" />
    <meta
      name="keywords"
      content="DCCS, èªçŸ¥å½ˆæ€§, åŸ·è¡ŒåŠŸèƒ½, è½éšœå­¸ç”Ÿ, ç‰¹æ®Šæ•™è‚², å­¸è¡“ç ”ç©¶, èªçŸ¥è¨“ç·´"
    />
    <meta name="classification" content="Education, Academic Research" />
    <meta name="category" content="Education" />
    <meta name="robots" content="index, follow" />

    <!-- ===== å®‰å…¨æ€§è¨­å®š (Content Security Policy) ===== -->
    <meta
      http-equiv="Content-Security-Policy"
      content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'none'; frame-ancestors 'none'; form-action 'self'; base-uri 'self';"
    />

    <!-- ===== é˜²æ­¢å®‰å…¨æ”»æ“Š ===== -->
    <meta http-equiv="X-Frame-Options" content="DENY" />
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />

    <!-- ===== Open Graph (ç¤¾ç¾¤åˆ†äº«) ===== -->
    <meta property="og:title" content="DCCSèªçŸ¥å½ˆæ€§è¨“ç·´æ¨¡çµ„ - è½éšœå­¸ç”Ÿå°ˆç”¨" />
    <meta
      property="og:description"
      content="ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»å­¸è¡“ç ”ç©¶å·¥å…·ï¼Œå°ˆç‚ºè½éšœå­¸ç”Ÿè¨­è¨ˆçš„èªçŸ¥å½ˆæ€§è¨“ç·´ç³»çµ±"
    />
    <meta property="og:type" content="website" />

    <title>
      DCCSèªçŸ¥å½ˆæ€§è¨“ç·´æ¨¡çµ„ - è½éšœå­¸ç”Ÿå°ˆç”¨ | ä¸­åŸå¤§å­¸ç‰¹æ•™ç³»å­¸è¡“ç ”ç©¶å·¥å…·
    </title>
    <style>
      /* =================================================================
           å…¨åŸŸæ¨£å¼è¨­å®š (Global Styles)
           - æ•™å­¸èªªæ˜ï¼šé€™éƒ¨åˆ†å®šç¾©æ•´å€‹ç¶²é çš„åŸºæœ¬å¤–è§€
           - box-sizing: border-box è®“å¯¬åº¦è¨ˆç®—æ›´ç›´è§€
           ================================================================= */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        /* æ•™å­¸èªªæ˜ï¼šä½¿ç”¨æ¼¸å±¤èƒŒæ™¯è®“ç•«é¢æ›´æœ‰è³ªæ„Ÿ */
        font-family: "Microsoft JhengHei", Arial, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
      }

      /* =================================================================
           éŠæˆ²ä¸»å®¹å™¨ (Main Game Container)
           - æ•™å­¸èªªæ˜ï¼šä½¿ç”¨ flexbox è®“å…§å®¹å‚ç›´æ’åˆ—
           - ã€ä¿®æ­£å•é¡Œ1ã€‘ï¼šèª¿æ•´å®¹å™¨å¤§å°ï¼Œç¢ºä¿æŒ‰éˆ•åœ¨å¯è¦–ç¯„åœå…§
           ================================================================= */
      #gameContainer {
        width: 90vw;
        max-width: 1200px;
        height: 85vh; /* ã€ä¿®æ­£ã€‘å¾ 90vh æ”¹ç‚º 85vhï¼Œç•™æ›´å¤šç©ºé–“çµ¦æŒ‰éˆ• */
        max-height: 900px; /* ã€æ–°å¢ã€‘é™åˆ¶æœ€å¤§é«˜åº¦ï¼Œé¿å…è¶…å‡ºè¢å¹• */
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        display: flex;
        flex-direction: column;
        position: relative;
        overflow-y: auto; /* ã€ä¿®æ­£ã€‘å…è¨±å‚ç›´æ²å‹• */
      }

      /* =================================================================
           æ¨™é¡Œå€åŸŸ (Header Area)
           ================================================================= */
      #header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 15px; /* ã€ä¿®æ­£ã€‘å¾ 20px æ¸›å°‘åˆ° 15px */
        text-align: center;
        font-size: 20px; /* ã€ä¿®æ­£ã€‘å¾ 24px æ¸›å°‘åˆ° 20px */
        font-weight: bold;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        flex-shrink: 0; /* ã€æ–°å¢ã€‘é˜²æ­¢æ¨™é¡Œè¢«å£“ç¸® */
      }

      /* =================================================================
           ä¸»è¦éŠæˆ²å€åŸŸ (Main Game Area)
           ================================================================= */
      #mainArea {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: flex-start; /* ã€ä¿®æ­£ã€‘å¾ center æ”¹ç‚º flex-start */
        align-items: center;
        padding: 30px 40px; /* ã€ä¿®æ­£ã€‘æ¸›å°‘ä¸Šä¸‹padding */
        position: relative;
        overflow-y: auto; /* ã€æ–°å¢ã€‘å…è¨±å…§å®¹æ²å‹• */
      }

      /* =================================================================
           ç•«é¢å€å¡Š (Screen Sections)
           - æ•™å­¸èªªæ˜ï¼šæ‰€æœ‰ç•«é¢é è¨­éš±è—ï¼Œé€é .active é¡åˆ¥é¡¯ç¤º
           ================================================================= */
      .screen {
        display: none;
        width: 100%;
        height: 100%;
        flex-direction: column;
        justify-content: flex-start; /* ã€ä¿®æ­£ã€‘å¾ center æ”¹ç‚º flex-start */
        align-items: center;
        text-align: center;
        padding-bottom: 20px; /* ã€æ–°å¢ã€‘åº•éƒ¨ç•™ç™½ */
      }

      .screen.active {
        display: flex;
      }

      /* =================================================================
           é¦–é ç•«é¢ (Landing Screen)
           ================================================================= */
      #landingScreen h2 {
        font-size: 28px; /* ã€ä¿®æ­£ã€‘å¾ 32px æ¸›å°‘ */
        color: #667eea;
        margin-bottom: 20px; /* ã€ä¿®æ­£ã€‘å¾ 30px æ¸›å°‘ */
      }

      #landingScreen p {
        font-size: 16px; /* ã€ä¿®æ­£ã€‘å¾ 18px æ¸›å°‘ */
        color: #666;
        margin-bottom: 15px; /* ã€ä¿®æ­£ã€‘å¾ 20px æ¸›å°‘ */
        line-height: 1.6;
      }

      /* =================================================================
           è¼¸å…¥æ¬„ä½æ¨£å¼ (Input Field Styles)
           ================================================================= */
      .input-group {
        margin: 20px 0; /* ã€ä¿®æ­£ã€‘å¾ 30px æ¸›å°‘ */
      }

      .input-group label {
        display: block;
        font-size: 16px; /* ã€ä¿®æ­£ã€‘å¾ 18px æ¸›å°‘ */
        color: #333;
        margin-bottom: 10px;
      }

      .input-group input {
        padding: 12px 20px; /* ã€ä¿®æ­£ã€‘å¾ 15px æ¸›å°‘ */
        font-size: 16px; /* ã€ä¿®æ­£ã€‘å¾ 18px æ¸›å°‘ */
        border: 2px solid #667eea;
        border-radius: 10px;
        width: 300px;
        text-align: center;
      }

      /* =================================================================
           æŒ‰éˆ•æ¨£å¼ (Button Styles)
           - æ•™å­¸èªªæ˜ï¼šä½¿ç”¨æ¼¸å±¤èƒŒæ™¯å’Œ hover æ•ˆæœæå‡äº’å‹•æ€§
           ================================================================= */
      .btn {
        padding: 12px 35px; /* ã€ä¿®æ­£ã€‘å¾ 15px 40px æ¸›å°‘ */
        font-size: 16px; /* ã€ä¿®æ­£ã€‘å¾ 18px æ¸›å°‘ */
        font-weight: bold;
        color: white;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border: none;
        border-radius: 50px;
        cursor: pointer;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
        margin: 10px;
      }

      .btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
      }

      .btn:active {
        transform: translateY(0);
      }

      .btn-secondary {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      }

      /* =================================================================
           èªªæ˜ç•«é¢ (Instruction Screen)
           ================================================================= */
      .instruction-box {
        background: #f8f9fa;
        padding: 25px; /* ã€ä¿®æ­£ã€‘å¾ 30px æ¸›å°‘ */
        border-radius: 15px;
        max-width: 800px;
        margin: 15px auto; /* ã€ä¿®æ­£ã€‘å¾ 20px æ¸›å°‘ */
        text-align: left;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .instruction-box h3 {
        color: #667eea;
        font-size: 22px; /* ã€ä¿®æ­£ã€‘å¾ 24px æ¸›å°‘ */
        margin-bottom: 15px; /* ã€ä¿®æ­£ã€‘å¾ 20px æ¸›å°‘ */
        text-align: center;
      }

      .instruction-box ul {
        list-style: none;
        padding: 0;
      }

      .instruction-box li {
        padding: 12px; /* ã€ä¿®æ­£ã€‘å¾ 15px æ¸›å°‘ */
        margin: 8px 0; /* ã€ä¿®æ­£ã€‘å¾ 10px æ¸›å°‘ */
        background: white;
        border-left: 4px solid #667eea;
        border-radius: 5px;
        font-size: 15px; /* ã€ä¿®æ­£ã€‘å¾ 16px æ¸›å°‘ */
      }

      .instruction-box .highlight {
        color: #f5576c;
        font-weight: bold;
      }

      /* =================================================================
           è¦–è¦ºæç¤ºå€åŸŸ (Visual Cue Area)
           ã€ä¿®æ­£å•é¡Œ3ã€‘åˆå§‹ç‹€æ…‹ç‚ºéš±è—ï¼Œåªåœ¨éšæ®µä¸‰é¡¯ç¤º
           - æ•™å­¸èªªæ˜ï¼šä½¿ç”¨ flexbox æ°´å¹³æ’åˆ—æç¤ºåœ–ç¤º
           ================================================================= */
      #visualCue {
        position: absolute;
        top: 20px;
        width: 100%;
        display: none; /* ã€ä¿®æ­£å•é¡Œ3ã€‘åˆå§‹éš±è—ï¼Œéšæ®µä¸‰æ‰é¡¯ç¤º */
        justify-content: center;
        align-items: center;
        gap: 20px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 10px;
        z-index: 10; /* ã€æ–°å¢ã€‘ç¢ºä¿åœ¨æœ€ä¸Šå±¤ */
      }

      .cue-item {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 20px;
        border-radius: 10px;
        font-size: 16px;
        font-weight: bold;
      }

      .cue-icon {
        width: 40px;
        height: 40px;
      }

      /* æ•™å­¸èªªæ˜ï¼šç•¶è¦å‰‡å•Ÿç”¨æ™‚ï¼Œé«˜äº®é¡¯ç¤ºå°æ‡‰çš„æç¤ºå¡ */
      .cue-active {
        background: #ffd700; /* é‡‘é»ƒè‰²èƒŒæ™¯ */
        transform: scale(1.1);
        box-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
      }

      /* =================================================================
           å¡ç‰‡é¡¯ç¤ºå€åŸŸ (Card Display Area)
           - æ•™å­¸èªªæ˜ï¼šä½¿ç”¨çµ•å°å®šä½è®“èƒŒæ™¯å’Œå‰æ™¯åˆ†å±¤é¡¯ç¤º
           ================================================================= */
      #cardDisplay {
        width: 400px;
        height: 500px;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        position: relative;
        transition: transform 0.3s;
      }

      #cardDisplay.correct {
        border: 5px solid #4caf50;
        animation: correctPulse 0.5s;
      }

      #cardDisplay.incorrect {
        border: 5px solid #f44336;
        animation: incorrectShake 0.5s;
      }

      @keyframes correctPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
      }

      @keyframes incorrectShake {
        0%,
        100% {
          transform: translateX(0);
        }
        25% {
          transform: translateX(-10px);
        }
        75% {
          transform: translateX(10px);
        }
      }

      /* å¡ç‰‡èƒŒæ™¯å±¤ (Card Background Layer) */
      #cardBackground {
        position: absolute;
        width: 100%;
        height: 100%;
        border-radius: 20px;
        z-index: 1;
      }

      /* å¡ç‰‡å‰æ™¯å±¤ (Card Foreground Layer) */
      #cardForeground {
        position: relative;
        z-index: 2;
        display: flex;
        justify-content: center;
        align-items: center;
      }

      #cardForeground svg {
        width: 200px;
        height: 200px;
      }

      /* =================================================================
           åˆ†é¡ç›’å­å€åŸŸ (Sorting Boxes Area)
           ================================================================= */
      #sortingBoxes {
        display: flex;
        gap: 100px;
        margin-top: 50px;
      }

      .sorting-box {
        width: 150px;
        height: 150px;
        border: 4px solid #333;
        border-radius: 15px;
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition:
          transform 0.2s,
          box-shadow 0.2s;
        background: white;
      }

      .sorting-box:hover {
        transform: scale(1.05);
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
      }

      .sorting-box svg {
        width: 80px;
        height: 80px;
        margin-bottom: 10px;
      }

      .sorting-box .label {
        font-size: 16px;
        font-weight: bold;
        color: #333;
      }

      /* å·¦éµç›’å­ (Left Box) */
      .sorting-box.left.active {
        border-color: #2196f3;
        box-shadow: 0 0 20px rgba(33, 150, 243, 0.5);
      }

      /* å³éµç›’å­ (Right Box) */
      .sorting-box.right.active {
        border-color: #f44336;
        box-shadow: 0 0 20px rgba(244, 67, 54, 0.5);
      }

      /* =================================================================
           å›é¥‹è¨Šæ¯å€åŸŸ (Feedback Message Area)
           ================================================================= */
      #feedbackMessage {
        position: absolute;
        bottom: 50px;
        font-size: 32px;
        font-weight: bold;
        opacity: 0;
        transition: opacity 0.3s;
      }

      #feedbackMessage.show {
        opacity: 1;
      }

      #feedbackMessage.correct {
        color: #4caf50;
      }

      #feedbackMessage.incorrect {
        color: #f44336;
      }

      /* =================================================================
           é€²åº¦æ¢ (Progress Bar)
           ================================================================= */
      #progressBar {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 10px;
        background: #e0e0e0;
      }

      #progressFill {
        height: 100%;
        background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
        width: 0%;
        transition: width 0.5s;
      }

      /* =================================================================
           çµ±è¨ˆè³‡æ–™å€åŸŸ (Statistics Area)
           ================================================================= */
      .stats-container {
        background: #f8f9fa;
        padding: 30px;
        border-radius: 15px;
        max-width: 600px;
        margin: 20px auto;
      }

      .stats-row {
        display: flex;
        justify-content: space-between;
        padding: 15px;
        margin: 10px 0;
        background: white;
        border-radius: 10px;
        font-size: 18px;
      }

      .stats-label {
        font-weight: bold;
        color: #667eea;
      }

      .stats-value {
        color: #333;
      }

      /* =================================================================
           éŸ¿æ‡‰å¼è¨­è¨ˆ (Responsive Design)
           ================================================================= */
      @media (max-width: 768px) {
        #gameContainer {
          width: 95vw;
          height: 95vh;
        }

        #header {
          font-size: 16px;
          padding: 12px;
        }

        #cardDisplay {
          width: 300px;
          height: 400px;
        }

        .sorting-box {
          width: 100px;
          height: 100px;
        }

        #sortingBoxes {
          gap: 50px;
        }
      }
    </style>
  </head>
  <body>
    <!-- éŠæˆ²ä¸»å®¹å™¨ -->
    <div id="gameContainer">
      <!-- æ¨™é¡Œå€åŸŸ -->
      <div id="header">DCCSèªçŸ¥å½ˆæ€§è¨“ç·´éŠæˆ²</div>

      <!-- ä¸»è¦éŠæˆ²å€åŸŸ -->
      <div id="mainArea">
        <!-- ========================================================
                 é¦–é ç•«é¢ (Landing Screen)
                 ã€ä¿®æ­£å•é¡Œ1ã€‘èª¿æ•´ç‰ˆé¢é…ç½®ï¼Œç¢ºä¿æŒ‰éˆ•åœ¨å¯è¦–ç¯„åœå…§
                 ã€ä¿®æ­£å•é¡Œ2ã€‘ç§»é™¤ç©ºç™½éµå•Ÿå‹•åŠŸèƒ½
                 ã€ä¿®æ­£å•é¡Œ3ã€‘æ”¹ç‚ºè‹¥æœªè¼¸å…¥å‰‡è‡ªå‹•è¨­ç‚º "NoName"
                 ======================================================== -->
        <div id="landingScreen" class="screen active">
          <!-- å­¸è¡“ç ”ç©¶æ€§è³ªèªªæ˜ (ç¬¦åˆ GSB å®‰å…¨è¦ç¯„) -->
          <div
            style="
              background: #e3f2fd;
              padding: 15px;
              border-radius: 15px;
              margin-bottom: 20px;
              max-width: 600px;
              text-align: left;
            "
          >
            <h3 style="color: #1565c0; margin-bottom: 12px; font-size: 18px">
              ğŸ“š å­¸è¡“ç ”ç©¶å·¥å…·
            </h3>
            <p style="margin: 8px 0; line-height: 1.6; font-size: 14px">
              æœ¬ç³»çµ±ç‚º<strong>ä¸­åŸå¤§å­¸ç‰¹æ®Šæ•™è‚²å­¸ç³»</strong>ç¢©å£«ç­ç ”ç©¶å°ˆæ¡ˆï¼Œ
              å°ˆç‚º<strong>è½éšœå­¸ç”Ÿï¼ˆ7-12æ­²ï¼‰</strong>è¨­è¨ˆçš„èªçŸ¥å½ˆæ€§è¨“ç·´å·¥å…·ã€‚
            </p>
            <p style="margin: 8px 0; line-height: 1.6; font-size: 14px">
              <strong style="color: #2e7d32">âœ… ä¸æ”¶é›†ä»»ä½•å€‹äººè³‡è¨Š</strong
              ><br />
              <strong style="color: #2e7d32">âœ… æ‰€æœ‰è³‡æ–™åƒ…å­˜æ–¼æ‚¨çš„ç€è¦½å™¨</strong
              ><br />
              <strong style="color: #2e7d32"
                >âœ… é–‹æºé€æ˜ï¼Œå¯æ–¼ GitHub æŸ¥é–±</strong
              >
            </p>
          </div>

          <h2>ğŸ§  æ­¡è¿ä¾†åˆ°èªçŸ¥å½ˆæ€§è¨“ç·´éŠæˆ²</h2>
          <p>é€™å€‹éŠæˆ²æœƒå¹«åŠ©ä½ ç·´ç¿’ã€Œè¦å‰‡è½‰æ›ã€çš„èƒ½åŠ›</p>
          <p>
            è«‹æº–å‚™å¥½éµç›¤ï¼Œä½¿ç”¨<strong>Féµï¼ˆå·¦æ‰‹é£ŸæŒ‡ï¼‰</strong> å’Œ
            <strong>Jéµï¼ˆå³æ‰‹é£ŸæŒ‡ï¼‰</strong>
          </p>

          <div class="input-group">
            <label for="participantId">è«‹è¼¸å…¥ä½ çš„ç·¨è™Ÿï¼ˆé¸å¡«ï¼‰ï¼š</label>
            <input type="text" id="participantId" placeholder="ä¾‹å¦‚ï¼šS001" />
          </div>

          <button class="btn" onclick="game.startGame()">é–‹å§‹éŠæˆ²</button>

          <!-- éš±ç§æ¬Šèˆ‡ä½¿ç”¨èªªæ˜ -->
          <div style="margin-top: 20px; font-size: 13px; color: #666">
            <p>
              ğŸ’¾ è³‡æ–™ä¸‹è¼‰èªªæ˜ï¼šéŠæˆ²çµæŸå¾Œå¯ä¸‹è¼‰ CSV
              ç´”æ–‡å­—æª”æ¡ˆä¾›ç ”ç©¶åˆ†æï¼Œä¸å«å€‹äººè­˜åˆ¥è³‡è¨Š
            </p>
            <p>
              ğŸ“– æ›´å¤šè³‡è¨Šè«‹åƒé–± <a href="#" style="color: #667eea">ä½¿ç”¨èªªæ˜</a>
            </p>
          </div>
        </div>

        <!-- ========================================================
                 éšæ®µä¸€èªªæ˜ç•«é¢ (Phase 1 Instruction)
                 ======================================================== -->
        <div id="phase1Instruction" class="screen">
          <div class="instruction-box">
            <h3>ğŸ“˜ éšæ®µä¸€ï¼šå­¸ç¿’è¦å‰‡ï¼ˆèƒŒæ™¯é¡è‰²åˆ†é¡ï¼‰</h3>
            <ul>
              <li>
                ä½ æœƒçœ‹åˆ°ä¸€å¼µå¡ç‰‡ï¼Œå¡ç‰‡æœ‰<span class="highlight">èƒŒæ™¯é¡è‰²</span
                >ï¼ˆè—è‰²æˆ–ç´…è‰²ï¼‰
              </li>
              <li>
                å¡ç‰‡å‰é¢é‚„æœ‰ä¸€å€‹<span class="highlight">é»‘è‰²åœ–æ¡ˆ</span>ï¼ˆçœ¼ç›ğŸ‘ï¸
                æˆ– å˜´å·´ğŸ˜Šï¼‰
              </li>
              <li>
                <strong>è«‹æ³¨æ„ã€ŒèƒŒæ™¯é¡è‰²ã€</strong>ï¼š <br />â€¢ è—è‰²èƒŒæ™¯ â†’
                æŒ‰<strong>Féµ</strong>ï¼ˆå·¦æ‰‹é£ŸæŒ‡ï¼‰ <br />â€¢ ç´…è‰²èƒŒæ™¯ â†’
                æŒ‰<strong>Jéµ</strong>ï¼ˆå³æ‰‹é£ŸæŒ‡ï¼‰
              </li>
              <li>
                âš ï¸ é€™å€‹éšæ®µè«‹<strong>å¿½ç•¥</strong>å‰é¢çš„é»‘è‰²åœ–æ¡ˆï¼ˆçœ¼ç›æˆ–å˜´å·´ï¼‰
              </li>
              <li>ç¸½å…±10é¡Œï¼ŒåŠ æ²¹ï¼</li>
            </ul>
          </div>
          <button class="btn" onclick="game.startPhase1()">æˆ‘æº–å‚™å¥½äº†ï¼</button>
        </div>

        <!-- ========================================================
                 éšæ®µäºŒèªªæ˜ç•«é¢ (Phase 2 Instruction)
                 ======================================================== -->
        <div id="phase2Instruction" class="screen">
          <div class="instruction-box">
            <h3>ğŸ“— éšæ®µäºŒï¼šè½‰æ›è¦å‰‡ï¼ˆè‡‰éƒ¨ç‰¹å¾µåˆ†é¡ï¼‰</h3>
            <ul>
              <li><span class="highlight">è¦å‰‡æ”¹è®Šäº†ï¼</span></li>
              <li>
                ç¾åœ¨è«‹<strong>æ³¨æ„ã€Œå‰é¢çš„é»‘è‰²åœ–æ¡ˆã€</strong>ï¼š <br />â€¢ çœ¼ç›ğŸ‘ï¸ â†’
                æŒ‰<strong>Féµ</strong>ï¼ˆå·¦æ‰‹é£ŸæŒ‡ï¼‰ <br />â€¢ å˜´å·´ğŸ˜Š â†’
                æŒ‰<strong>Jéµ</strong>ï¼ˆå³æ‰‹é£ŸæŒ‡ï¼‰
              </li>
              <li>âš ï¸ é€™å€‹éšæ®µè«‹<strong>å¿½ç•¥</strong>èƒŒæ™¯é¡è‰²</li>
              <li>è©¦è‘—å¿˜è¨˜ä¸Šä¸€å€‹éšæ®µçš„è¦å‰‡ï¼Œå°ˆæ³¨åœ¨æ–°è¦å‰‡ä¸Šï¼</li>
              <li>ç¸½å…±10é¡Œï¼Œä½ å¯ä»¥çš„ï¼</li>
            </ul>
          </div>
          <button class="btn" onclick="game.startPhase2()">æˆ‘æº–å‚™å¥½äº†ï¼</button>
        </div>

        <!-- ========================================================
                 éšæ®µä¸‰èªªæ˜ç•«é¢ (Phase 3 Instruction)
                 ======================================================== -->
        <div id="phase3Instruction" class="screen">
          <div class="instruction-box">
            <h3>ğŸ“• éšæ®µä¸‰ï¼šæ··åˆè½‰æ›ï¼ˆéš¨æ©Ÿåˆ‡æ›è¦å‰‡ï¼‰</h3>
            <ul>
              <li><span class="highlight">æœ€å¤§æŒ‘æˆ°ä¾†äº†ï¼</span></li>
              <li>æ¯ä¸€é¡Œéƒ½æœƒ<strong>éš¨æ©Ÿ</strong>å‘Šè¨´ä½ è¦ç”¨å“ªå€‹è¦å‰‡</li>
              <li>
                çœ‹åˆ°<strong style="color: blue">è—è‰²æ¨™ç¤º ğŸ¨</strong> â†’
                æŒ‰ã€ŒèƒŒæ™¯é¡è‰²ã€åˆ†é¡
              </li>
              <li>
                çœ‹åˆ°<strong style="color: orange">æ©˜è‰²æ¨™ç¤º ğŸ–¼ï¸</strong> â†’
                æŒ‰ã€Œå‰æ™¯åœ–æ¡ˆã€åˆ†é¡
              </li>
              <li>è¦éš¨æ™‚ä¿æŒæ³¨æ„åŠ›ï¼Œå¿«é€Ÿåˆ‡æ›è¦å‰‡ï¼</li>
              <li>ç¸½å…±16é¡Œï¼Œé€™æ˜¯æœ€å¾Œè¡åˆºï¼</li>
            </ul>
          </div>
          <button class="btn" onclick="game.startPhase3()">æŒ‘æˆ°é–‹å§‹ï¼</button>
        </div>

        <!-- ========================================================
                 éŠæˆ²é€²è¡Œç•«é¢ (Game Playing Screen)
                 ======================================================== -->
        <div id="gameScreen" class="screen">
          <!-- è¦–è¦ºæç¤ºå€åŸŸ -->
          <div id="visualCue">
            <div id="colorCue" class="cue-item">
              <svg class="cue-icon" viewBox="0 0 100 100">
                <rect width="100" height="100" rx="10" fill="#4a90e2" />
              </svg>
              <span>èƒŒæ™¯é¡è‰²</span>
            </div>
            <div id="shapeCue" class="cue-item">
              <svg class="cue-icon" viewBox="0 0 100 100">
                <rect
                  width="100"
                  height="100"
                  rx="10"
                  fill="white"
                  stroke="#333"
                  stroke-width="4"
                />
                <!-- ç°¡åŒ–çš„è‡‰éƒ¨ç‰¹å¾µåœ–ç¤º -->
                <ellipse cx="35" cy="45" rx="8" ry="10" fill="#333" />
                <ellipse cx="65" cy="45" rx="8" ry="10" fill="#333" />
                <path
                  d="M 30 65 Q 50 80 70 65"
                  stroke="#333"
                  stroke-width="4"
                  fill="none"
                  stroke-linecap="round"
                />
              </svg>
              <span>è‡‰éƒ¨ç‰¹å¾µ</span>
            </div>
          </div>

          <!-- å¡ç‰‡é¡¯ç¤ºå€åŸŸ -->
          <div id="cardDisplay">
            <!-- èƒŒæ™¯å±¤ (SVG Container) -->
            <div id="cardBackground"></div>
            <!-- å‰æ™¯å±¤ (SVG Container) -->
            <div id="cardForeground"></div>
          </div>

          <!-- åˆ†é¡ç›’å­ -->
          <div id="sortingBoxes">
            <div class="sorting-box left" id="leftBox">
              <div id="leftBoxIcon"></div>
              <div class="label">æŒ‰ F éµ</div>
            </div>
            <div class="sorting-box right" id="rightBox">
              <div id="rightBoxIcon"></div>
              <div class="label">æŒ‰ J éµ</div>
            </div>
          </div>

          <!-- å›é¥‹è¨Šæ¯ -->
          <div id="feedbackMessage"></div>

          <!-- é€²åº¦æ¢ -->
          <div id="progressBar">
            <div id="progressFill"></div>
          </div>
        </div>

        <!-- ========================================================
                 çµæœç•«é¢ (Results Screen)
                 ======================================================== -->
        <div id="resultsScreen" class="screen">
          <h2>ğŸ‰ æ­å–œå®Œæˆè¨“ç·´ï¼</h2>
          <div class="stats-container" id="statsContainer">
            <!-- çµ±è¨ˆæ•¸æ“šå°‡ç”±JavaScriptå‹•æ…‹ç”Ÿæˆ -->
          </div>
          <div>
            <button class="btn" onclick="game.exportData()">ğŸ’¾ ä¸‹è¼‰æ•¸æ“š</button>
            <button class="btn btn-secondary" onclick="game.restart()">
              ğŸ”„ é‡æ–°é–‹å§‹
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- ========================================================
         JavaScript éŠæˆ²é‚è¼¯
         æ•™å­¸èªªæ˜ï¼šé€™éƒ¨åˆ†åŒ…å«æ‰€æœ‰éŠæˆ²çš„æ ¸å¿ƒé‚è¼¯
         ======================================================== -->
    <script>
      // ============================================================
      // éŠæˆ²ç‰©ä»¶å®šç¾© (Game Object Definition)
      // æ•™å­¸èªªæ˜ï¼šä½¿ç”¨ç‰©ä»¶å°è£æ‰€æœ‰éŠæˆ²ç›¸é—œçš„è³‡æ–™å’Œæ–¹æ³•
      // ============================================================
      const game = {
        // ========================================================
        // éŠæˆ²ç‹€æ…‹è®Šæ•¸ (Game State Variables)
        // æ•™å­¸èªªæ˜ï¼šé€™äº›è®Šæ•¸è¿½è¹¤éŠæˆ²çš„ç•¶å‰ç‹€æ…‹
        // ========================================================
        participantId: "", // å—è©¦è€…ç·¨è™Ÿ
        currentPhase: 0, // ç•¶å‰éšæ®µ (1, 2, 3)
        currentTrial: 0, // ç•¶å‰è©¦é¡Œç·¨è™Ÿ
        totalTrials: 0, // ç•¶å‰éšæ®µç¸½é¡Œæ•¸
        currentCard: null, // ç•¶å‰å¡ç‰‡è³‡æ–™ {background, foreground}
        currentRule: "", // ç•¶å‰åˆ†é¡è¦å‰‡ ('color' or 'shape')
        startTime: 0, // è©¦é¡Œé–‹å§‹æ™‚é–“
        results: [], // æ‰€æœ‰è©¦é¡Œçµæœè¨˜éŒ„

        // ========================================================
        // å¡ç‰‡é…ç½® (Card Configuration)
        // æ•™å­¸èªªæ˜ï¼šå®šç¾©å¡ç‰‡çš„å¯èƒ½çµ„åˆ
        // èƒŒæ™¯é¡è‰²: 'blue' (è—è‰²) æˆ– 'red' (ç´…è‰²)
        // å‰æ™¯åœ–æ¡ˆ: 'eyes' (çœ¼ç›ğŸ‘ï¸) æˆ– 'mouth' (å˜´å·´ğŸ˜Š)
        // è¨­è¨ˆä¾æ“šï¼šè½éšœå­¸ç”Ÿå°è‡‰éƒ¨ç‰¹å¾µï¼ˆçœ¼ç›ã€å˜´å‹ï¼‰å…·é«˜åº¦è¦–è¦ºæ•æ„Ÿæ€§
        // ========================================================
        cardConfig: {
          backgrounds: ["blue", "red"],
          foregrounds: ["eyes", "mouth"],
        },

        // ========================================================
        // éšæ®µé…ç½® (Phase Configuration)
        // ========================================================
        phaseConfig: {
          1: { trials: 10, rule: "color" }, // éšæ®µä¸€ï¼šå›ºå®šæŒ‰é¡è‰²
          2: { trials: 10, rule: "shape" }, // éšæ®µäºŒï¼šå›ºå®šæŒ‰åœ–æ¡ˆ
          3: { trials: 16, rule: "mixed" }, // éšæ®µä¸‰ï¼šæ··åˆéš¨æ©Ÿ
        },

        // ========================================================
        // SVG åœ–æª”å®¹å™¨ (SVG Assets Container)
        // æ•™å­¸èªªæ˜ï¼šä½¿ç”¨ SVG æ ¼å¼å¯ä»¥ç„¡é™ç¸®æ”¾è€Œä¸å¤±çœŸ
        // è¨­è¨ˆç†å¿µï¼šæ¡ç”¨ã€Œçœ¼ç›vså˜´å·´ã€ç¬¦åˆè½éšœå­¸ç”Ÿè¦–è¦ºå­¸ç¿’ç‰¹æ€§
        // - è½éšœå­¸ç”Ÿé«˜åº¦ä¾è³´è‡‰éƒ¨ç·šç´¢ï¼ˆè®€å”‡ã€è¡¨æƒ…è¾¨è­˜ï¼‰
        // - çœ¼ç›èˆ‡å˜´å·´æ˜¯æ—¥å¸¸æºé€šä¸­æœ€å¸¸æ³¨æ„çš„è¦–è¦ºç„¦é»
        // - å¾®ç¬‘å¼§ç·šè¨­è¨ˆé™ä½å¿ƒç†è² æ“”ï¼Œç¬¦åˆå‹å–„ä»‹é¢åŸå‰‡
        // ========================================================
        svgAssets: {
          // èƒŒæ™¯é¡è‰² (Backgrounds) - 400x500px
          backgrounds: {
            blue: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 500" width="100%" height="100%">
                            <rect width="400" height="500" rx="20" fill="#4A90E2"/>
                          </svg>`,
            red: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 500" width="100%" height="100%">
                           <rect width="400" height="500" rx="20" fill="#E74C3C"/>
                         </svg>`,
          },
          // å‰æ™¯åœ–æ¡ˆ (Foregrounds) - 200x200px é»‘è‰²
          foregrounds: {
            eyes: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
                            <ellipse cx="60" cy="100" rx="25" ry="35" fill="#000000"/>
                            <ellipse cx="140" cy="100" rx="25" ry="35" fill="#000000"/>
                          </svg>`,
            mouth: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
                             <path d="M 50 100 Q 100 140 150 100" 
                                   stroke="#000000" 
                                   stroke-width="15" 
                                   fill="none" 
                                   stroke-linecap="round"/>
                           </svg>`,
          },
          // åˆ†é¡ç›’å­åœ–ç¤º (Sorting Box Icons)
          boxes: {
            blueBox: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80" width="80" height="80">
                               <rect width="80" height="80" rx="10" fill="#4A90E2"/>
                             </svg>`,
            redBox: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80" width="80" height="80">
                              <rect width="80" height="80" rx="10" fill="#E74C3C"/>
                            </svg>`,
            eyesBox: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80" width="80" height="80">
                               <ellipse cx="25" cy="40" rx="10" ry="14" fill="#000000"/>
                               <ellipse cx="55" cy="40" rx="10" ry="14" fill="#000000"/>
                             </svg>`,
            mouthBox: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 80 80" width="80" height="80">
                                <path d="M 20 40 Q 40 60 60 40" 
                                      stroke="#000000" 
                                      stroke-width="8" 
                                      fill="none" 
                                      stroke-linecap="round"/>
                              </svg>`,
          },
        },

        // ========================================================
        // åˆå§‹åŒ–éŠæˆ² (Initialize Game)
        // æ•™å­¸èªªæ˜ï¼šç•¶é é¢è¼‰å…¥æ™‚è‡ªå‹•åŸ·è¡Œï¼Œè¨­å®šéµç›¤ç›£è½å™¨
        // ã€ä¿®æ­£å•é¡Œ2ã€‘ç§»é™¤ç©ºç™½éµå•Ÿå‹•åŠŸèƒ½
        // ========================================================
        init() {
          console.log("ğŸ® éŠæˆ²ç³»çµ±åˆå§‹åŒ–...");

          // ç¶å®šéµç›¤äº‹ä»¶ç›£è½å™¨
          // æ•™å­¸èªªæ˜ï¼šaddEventListener è®“æˆ‘å€‘ç›£è½ä½¿ç”¨è€…çš„éµç›¤å‹•ä½œ
          document.addEventListener("keydown", (e) => this.handleKeyPress(e));

          console.log("âœ… éŠæˆ²ç³»çµ±åˆå§‹åŒ–å®Œæˆ");
        },

        // ========================================================
        // é–‹å§‹éŠæˆ² (Start Game)
        // ã€ä¿®æ­£å•é¡Œ3ã€‘æœªè¼¸å…¥ç·¨è™Ÿæ™‚è‡ªå‹•è¨­ç‚º "NoName"
        // ========================================================
        startGame() {
          // å–å¾—å—è©¦è€…ç·¨è™Ÿ
          const inputId = document.getElementById("participantId").value.trim();

          // ã€ä¿®æ­£å•é¡Œ3ã€‘è‹¥æœªè¼¸å…¥ï¼Œè‡ªå‹•è¨­ç‚º "NoName"
          if (!inputId) {
            this.participantId = "NoName";
            console.log("âš ï¸ æœªè¼¸å…¥ç·¨è™Ÿï¼Œè‡ªå‹•è¨­å®šç‚º NoName");
          } else {
            this.participantId = inputId;
          }

          console.log(`ğŸš€ éŠæˆ²é–‹å§‹ - å—è©¦è€…: ${this.participantId}`);

          // åˆ‡æ›åˆ°éšæ®µä¸€èªªæ˜ç•«é¢
          this.showScreen("phase1Instruction");
        },

        // ========================================================
        // é–‹å§‹éšæ®µä¸€ (Start Phase 1)
        // æ•™å­¸èªªæ˜ï¼šå›ºå®šæŒ‰èƒŒæ™¯é¡è‰²åˆ†é¡
        // ========================================================
        startPhase1() {
          this.currentPhase = 1;
          this.currentTrial = 0;
          this.totalTrials = this.phaseConfig[1].trials;
          this.currentRule = "color"; // å›ºå®šæŒ‰é¡è‰²åˆ†é¡

          console.log("ğŸ“˜ éšæ®µä¸€é–‹å§‹ - æŒ‰èƒŒæ™¯é¡è‰²åˆ†é¡");

          // æ›´æ–°åˆ†é¡ç›’å­åœ–ç¤ºç‚ºé¡è‰²
          this.updateSortingBoxes("color");

          // éš±è—è¦–è¦ºæç¤ºï¼ˆéšæ®µä¸€äºŒä¸éœ€è¦ï¼‰
          document.getElementById("visualCue").style.display = "none";

          // é–‹å§‹ç¬¬ä¸€é¡Œ
          this.nextTrial();
        },

        // ========================================================
        // é–‹å§‹éšæ®µäºŒ (Start Phase 2)
        // æ•™å­¸èªªæ˜ï¼šå›ºå®šæŒ‰å‰æ™¯åœ–æ¡ˆåˆ†é¡
        // ========================================================
        startPhase2() {
          this.currentPhase = 2;
          this.currentTrial = 0;
          this.totalTrials = this.phaseConfig[2].trials;
          this.currentRule = "shape"; // å›ºå®šæŒ‰åœ–æ¡ˆåˆ†é¡

          console.log("ğŸ“— éšæ®µäºŒé–‹å§‹ - æŒ‰å‰æ™¯åœ–æ¡ˆåˆ†é¡");

          // æ›´æ–°åˆ†é¡ç›’å­åœ–ç¤ºç‚ºåœ–æ¡ˆ
          this.updateSortingBoxes("shape");

          // éš±è—è¦–è¦ºæç¤º
          document.getElementById("visualCue").style.display = "none";

          // é–‹å§‹ç¬¬ä¸€é¡Œ
          this.nextTrial();
        },

        // ========================================================
        // é–‹å§‹éšæ®µä¸‰ (Start Phase 3)
        // ã€ä¿®æ­£å•é¡Œ4ã€‘ç¢ºä¿è¦–è¦ºæç¤ºæ­£ç¢ºé¡¯ç¤º
        // æ•™å­¸èªªæ˜ï¼šæ··åˆéš¨æ©Ÿè¦å‰‡ï¼Œéœ€è¦è¦–è¦ºæç¤º
        // ========================================================
        startPhase3() {
          this.currentPhase = 3;
          this.currentTrial = 0;
          this.totalTrials = this.phaseConfig[3].trials;

          console.log("ğŸ“• éšæ®µä¸‰é–‹å§‹ - æ··åˆéš¨æ©Ÿè¦å‰‡");

          // ã€ä¿®æ­£å•é¡Œ4ã€‘éšæ®µä¸‰éœ€è¦é¡¯ç¤ºè¦–è¦ºæç¤º
          const visualCue = document.getElementById("visualCue");
          visualCue.style.display = "flex"; // ç¢ºä¿é¡¯ç¤º
          console.log("âœ… è¦–è¦ºæç¤ºå·²å•Ÿç”¨");

          // é–‹å§‹ç¬¬ä¸€é¡Œ
          this.nextTrial();
        },

        // ========================================================
        // ä¸‹ä¸€é¡Œ (Next Trial)
        // æ•™å­¸èªªæ˜ï¼šæ§åˆ¶é¡Œç›®é€²åº¦çš„æ ¸å¿ƒå‡½æ•¸
        // ========================================================
        nextTrial() {
          // æª¢æŸ¥æ˜¯å¦å®Œæˆç•¶å‰éšæ®µ
          if (this.currentTrial >= this.totalTrials) {
            this.finishPhase();
            return;
          }

          this.currentTrial++;

          // ç”Ÿæˆéš¨æ©Ÿå¡ç‰‡
          this.currentCard = this.generateRandomCard();

          // éšæ®µä¸‰éœ€è¦éš¨æ©Ÿæ±ºå®šè¦å‰‡
          if (this.currentPhase === 3) {
            this.currentRule = Math.random() < 0.5 ? "color" : "shape";
            this.updateVisualCue(this.currentRule);
            this.updateSortingBoxes(this.currentRule);
          }

          // é¡¯ç¤ºå¡ç‰‡
          this.displayCard(this.currentCard);

          // è¨˜éŒ„é–‹å§‹æ™‚é–“
          this.startTime = Date.now();

          // æ›´æ–°é€²åº¦æ¢
          this.updateProgressBar();

          console.log(
            `ğŸ“ éšæ®µ${this.currentPhase} ç¬¬${this.currentTrial}é¡Œ - è¦å‰‡: ${this.currentRule}`,
          );
        },

        // ========================================================
        // ç”Ÿæˆéš¨æ©Ÿå¡ç‰‡ (Generate Random Card)
        // æ•™å­¸èªªæ˜ï¼šéš¨æ©Ÿçµ„åˆèƒŒæ™¯å’Œå‰æ™¯
        // ========================================================
        generateRandomCard() {
          const backgrounds = this.cardConfig.backgrounds;
          const foregrounds = this.cardConfig.foregrounds;

          const randomBackground =
            backgrounds[Math.floor(Math.random() * backgrounds.length)];
          const randomForeground =
            foregrounds[Math.floor(Math.random() * foregrounds.length)];

          return {
            background: randomBackground,
            foreground: randomForeground,
          };
        },

        // ========================================================
        // é¡¯ç¤ºå¡ç‰‡ (Display Card)
        // æ•™å­¸èªªæ˜ï¼šå°‡SVGåœ–æª”æ’å…¥åˆ°å°æ‡‰çš„å®¹å™¨ä¸­
        // ========================================================
        displayCard(card) {
          // é¡¯ç¤ºèƒŒæ™¯
          document.getElementById("cardBackground").innerHTML =
            this.svgAssets.backgrounds[card.background];

          // é¡¯ç¤ºå‰æ™¯
          document.getElementById("cardForeground").innerHTML =
            this.svgAssets.foregrounds[card.foreground];

          // åˆ‡æ›åˆ°éŠæˆ²ç•«é¢
          this.showScreen("gameScreen");
        },

        // ========================================================
        // æ›´æ–°è¦–è¦ºæç¤º (Update Visual Cue)
        // ã€ä¿®æ­£å•é¡Œ4ã€‘ç¢ºä¿æç¤ºå¡æ­£ç¢ºé«˜äº®
        // æ•™å­¸èªªæ˜ï¼šåœ¨éšæ®µä¸‰æ™‚ï¼Œé«˜äº®ç•¶å‰è¦å‰‡çš„æç¤ºå¡
        // ========================================================
        updateVisualCue(rule) {
          const colorCue = document.getElementById("colorCue");
          const shapeCue = document.getElementById("shapeCue");

          // ç§»é™¤æ‰€æœ‰é«˜äº®
          colorCue.classList.remove("cue-active");
          shapeCue.classList.remove("cue-active");

          // æ ¹æ“šè¦å‰‡æ·»åŠ é«˜äº®
          if (rule === "color") {
            colorCue.classList.add("cue-active");
            console.log("ğŸ¨ è¦–è¦ºæç¤ºï¼šèƒŒæ™¯é¡è‰²");
          } else {
            shapeCue.classList.add("cue-active");
            console.log("ğŸ–¼ï¸ è¦–è¦ºæç¤ºï¼šè‡‰éƒ¨ç‰¹å¾µ");
          }
        },

        // ========================================================
        // æ›´æ–°åˆ†é¡ç›’å­ (Update Sorting Boxes)
        // æ•™å­¸èªªæ˜ï¼šæ ¹æ“šç•¶å‰è¦å‰‡æ›´æ–°åˆ†é¡ç›’å­çš„åœ–ç¤º
        // ========================================================
        updateSortingBoxes(rule) {
          const leftBoxIcon = document.getElementById("leftBoxIcon");
          const rightBoxIcon = document.getElementById("rightBoxIcon");

          if (rule === "color") {
            // æŒ‰é¡è‰²ï¼šå·¦=è—è‰²ï¼Œå³=ç´…è‰²
            leftBoxIcon.innerHTML = this.svgAssets.boxes.blueBox;
            rightBoxIcon.innerHTML = this.svgAssets.boxes.redBox;
          } else {
            // æŒ‰åœ–æ¡ˆï¼šå·¦=çœ¼ç›ï¼Œå³=å˜´å·´
            leftBoxIcon.innerHTML = this.svgAssets.boxes.eyesBox;
            rightBoxIcon.innerHTML = this.svgAssets.boxes.mouthBox;
          }
        },

        // ========================================================
        // æ›´æ–°é€²åº¦æ¢ (Update Progress Bar)
        // ========================================================
        updateProgressBar() {
          const progress = (this.currentTrial / this.totalTrials) * 100;
          document.getElementById("progressFill").style.width = `${progress}%`;
        },

        // ========================================================
        // è™•ç†éµç›¤æŒ‰éµ (Handle Key Press)
        // ã€ä¿®æ­£å•é¡Œ2ã€‘ç§»é™¤ç©ºç™½éµå•Ÿå‹•
        // ã€ä¿®æ­£å•é¡Œ4ã€‘åªè™•ç† F å’Œ J éµ
        // æ•™å­¸èªªæ˜ï¼šç›£è½ä½¿ç”¨è€…çš„æŒ‰éµï¼Œåªåœ¨éŠæˆ²é€²è¡Œä¸­æ‰è™•ç†
        // ========================================================
        handleKeyPress(e) {
          // åªåœ¨éŠæˆ²é€²è¡Œä¸­æ‰è™•ç†æŒ‰éµ
          const gameScreen = document.getElementById("gameScreen");
          if (!gameScreen.classList.contains("active")) return;

          // ã€ä¿®æ­£å•é¡Œ4ã€‘æŒ‰Féµï¼ˆå·¦é‚Šï¼‰æˆ– Jéµï¼ˆå³é‚Šï¼‰
          // F = å·¦æ‰‹é£ŸæŒ‡ï¼ŒJ = å³æ‰‹é£ŸæŒ‡ï¼ˆéµç›¤æ¨™æº–æ‰“å­—ä½ç½®ï¼‰
          if (e.key === "f" || e.key === "F") {
            e.preventDefault(); // é˜²æ­¢é é¢æ»¾å‹•
            this.checkAnswer("KeyF");
          } else if (e.key === "j" || e.key === "J") {
            e.preventDefault(); // é˜²æ­¢é é¢æ»¾å‹•
            this.checkAnswer("KeyJ");
          }
        },

        // ========================================================
        // æª¢æŸ¥ç­”æ¡ˆ (Check Answer)
        // ã€ä¿®æ­£å•é¡Œ4ã€‘ç¢ºä¿ F/J éµå°æ‡‰æ­£ç¢º
        // æ•™å­¸èªªæ˜ï¼šåˆ¤æ–·ä½¿ç”¨è€…çš„ç­”æ¡ˆæ˜¯å¦æ­£ç¢º
        // ========================================================
        checkAnswer(keyPressed) {
          // è¨ˆç®—åæ‡‰æ™‚é–“
          const reactionTime = Date.now() - this.startTime;

          // ã€ä¿®æ­£å•é¡Œ4ã€‘åˆ¤æ–·æ­£ç¢ºç­”æ¡ˆï¼ˆFéµ=å·¦é‚Šï¼ŒJéµ=å³é‚Šï¼‰
          let correctKey;
          if (this.currentRule === "color") {
            // æŒ‰é¡è‰²ï¼šè—è‰²â†’Féµï¼ˆå·¦ï¼‰ï¼Œç´…è‰²â†’Jéµï¼ˆå³ï¼‰
            correctKey =
              this.currentCard.background === "blue" ? "KeyF" : "KeyJ";
          } else {
            // æŒ‰è‡‰éƒ¨ç‰¹å¾µï¼šçœ¼ç›â†’Féµï¼ˆå·¦ï¼‰ï¼Œå˜´å·´â†’Jéµï¼ˆå³ï¼‰
            correctKey =
              this.currentCard.foreground === "eyes" ? "KeyF" : "KeyJ";
          }

          const isCorrect = keyPressed === correctKey;

          // è¨˜éŒ„çµæœ
          this.recordResult({
            participantId: this.participantId,
            phase: this.currentPhase,
            trial: this.currentTrial,
            rule: this.currentRule,
            cardBackground: this.currentCard.background,
            cardForeground: this.currentCard.foreground,
            keyPressed: keyPressed,
            correctKey: correctKey,
            isCorrect: isCorrect,
            reactionTime: reactionTime,
            timestamp: new Date().toISOString(),
          });

          // é¡¯ç¤ºå›é¥‹
          this.showFeedback(isCorrect);

          // 1ç§’å¾Œé€²å…¥ä¸‹ä¸€é¡Œ
          setTimeout(() => {
            this.nextTrial();
          }, 1000);
        },

        // ========================================================
        // è¨˜éŒ„çµæœ (Record Result)
        // æ•™å­¸èªªæ˜ï¼šå°‡æ¯ä¸€é¡Œçš„çµæœå­˜å…¥ results é™£åˆ—
        // ========================================================
        recordResult(data) {
          this.results.push(data);
          console.log(
            `ğŸ“Š è¨˜éŒ„çµæœ - éšæ®µ${data.phase} ç¬¬${data.trial}é¡Œ: ${data.isCorrect ? "âœ…æ­£ç¢º" : "âŒéŒ¯èª¤"} (${data.reactionTime}ms)`,
          );
        },

        // ========================================================
        // é¡¯ç¤ºå›é¥‹ (Show Feedback)
        // æ•™å­¸èªªæ˜ï¼šç”¨è¦–è¦ºå’Œæ–‡å­—å‘Šè¨´ä½¿ç”¨è€…ç­”å°æˆ–ç­”éŒ¯
        // ========================================================
        showFeedback(isCorrect) {
          const cardDisplay = document.getElementById("cardDisplay");
          const feedbackMsg = document.getElementById("feedbackMessage");

          if (isCorrect) {
            cardDisplay.classList.add("correct");
            feedbackMsg.textContent = "âœ… ç­”å°äº†ï¼";
            feedbackMsg.className = "show correct";
          } else {
            cardDisplay.classList.add("incorrect");
            feedbackMsg.textContent = "âŒ ç­”éŒ¯äº†ï¼";
            feedbackMsg.className = "show incorrect";
          }

          // 0.5ç§’å¾Œéš±è—å›é¥‹
          setTimeout(() => {
            feedbackMsg.classList.remove("show");
            cardDisplay.classList.remove("correct", "incorrect");
          }, 500);
        },

        // ========================================================
        // å®Œæˆéšæ®µ (Finish Phase)
        // æ•™å­¸èªªæ˜ï¼šè™•ç†éšæ®µçµæŸå¾Œçš„æµç¨‹
        // ========================================================
        finishPhase() {
          console.log(`ğŸ éšæ®µ${this.currentPhase}å®Œæˆ`);

          if (this.currentPhase === 1) {
            // é€²å…¥éšæ®µäºŒ
            this.showScreen("phase2Instruction");
          } else if (this.currentPhase === 2) {
            // é€²å…¥éšæ®µä¸‰
            this.showScreen("phase3Instruction");
          } else {
            // é¡¯ç¤ºçµæœ
            this.showResults();
          }
        },

        // ========================================================
        // é¡¯ç¤ºçµæœ (Show Results)
        // æ•™å­¸èªªæ˜ï¼šè¨ˆç®—çµ±è¨ˆæ•¸æ“šä¸¦é¡¯ç¤º
        // ========================================================
        showResults() {
          console.log("ğŸ‰ æ‰€æœ‰éšæ®µå®Œæˆï¼");

          // è¨ˆç®—çµ±è¨ˆæ•¸æ“š
          const stats = this.calculateStatistics();

          // é¡¯ç¤ºçµ±è¨ˆæ•¸æ“š
          const statsContainer = document.getElementById("statsContainer");
          statsContainer.innerHTML = `
                    <div class="stats-row">
                        <span class="stats-label">ç¸½é¡Œæ•¸ï¼š</span>
                        <span class="stats-value">${stats.totalTrials} é¡Œ</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">ç­”å°ï¼š</span>
                        <span class="stats-value">${stats.correctCount} é¡Œ</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">æ­£ç¢ºç‡ï¼š</span>
                        <span class="stats-value">${stats.accuracy.toFixed(1)}%</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">å¹³å‡åæ‡‰æ™‚é–“ï¼š</span>
                        <span class="stats-value">${stats.avgReactionTime.toFixed(0)} ms</span>
                    </div>
                `;

          // åˆ‡æ›åˆ°çµæœç•«é¢
          this.showScreen("resultsScreen");
        },

        // ========================================================
        // è¨ˆç®—çµ±è¨ˆæ•¸æ“š (Calculate Statistics)
        // æ•™å­¸èªªæ˜ï¼šå¾ results é™£åˆ—ä¸­è¨ˆç®—å„ç¨®çµ±è¨ˆæŒ‡æ¨™
        // ========================================================
        calculateStatistics() {
          const totalTrials = this.results.length;
          const correctCount = this.results.filter((r) => r.isCorrect).length;
          const accuracy = (correctCount / totalTrials) * 100;

          const totalReactionTime = this.results.reduce(
            (sum, r) => sum + r.reactionTime,
            0,
          );
          const avgReactionTime = totalReactionTime / totalTrials;

          return {
            totalTrials,
            correctCount,
            accuracy,
            avgReactionTime,
          };
        },

        // ========================================================
        // åŒ¯å‡ºè³‡æ–™ (Export Data)
        // æ•™å­¸èªªæ˜ï¼šå°‡çµæœè½‰æ›ç‚º CSV æ ¼å¼ä¸¦ä¸‹è¼‰
        // ç¬¦åˆ GSB å®‰å…¨è¦ç¯„ï¼š
        // 1. ç´”æ–‡å­—æ ¼å¼ï¼ˆCSVï¼‰
        // 2. ä½¿ç”¨è€…ä¸»å‹•è§¸ç™¼
        // 3. ä¸å«å€‹äººè­˜åˆ¥è³‡è¨Š
        // ========================================================
        exportData() {
          console.log("ğŸ’¾ é–‹å§‹åŒ¯å‡ºè³‡æ–™...");

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ1ã€‘å»ºç«‹ CSV æ¨™é ­
          // CSV æ ¼å¼ï¼šé€—è™Ÿåˆ†éš”å€¼ï¼Œç¬¬ä¸€è¡Œæ˜¯æ¬„ä½åç¨±
          const headers = [
            "participant_id", // å—è©¦è€…ç·¨è™Ÿ
            "phase", // éšæ®µ (1, 2, 3)
            "trial", // é¡Œè™Ÿ
            "rule", // è¦å‰‡ (color/shape)
            "card_background", // å¡ç‰‡èƒŒæ™¯é¡è‰²
            "card_foreground", // å¡ç‰‡å‰æ™¯åœ–æ¡ˆ
            "key_pressed", // ä½¿ç”¨è€…æŒ‰çš„éµ
            "correct_key", // æ­£ç¢ºçš„éµ
            "is_correct", // æ˜¯å¦æ­£ç¢º
            "reaction_time_ms", // åæ‡‰æ™‚é–“ï¼ˆæ¯«ç§’ï¼‰
            "timestamp", // æ™‚é–“æˆ³è¨˜
          ];

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ2ã€‘å°‡é™£åˆ—è½‰æ›ç‚º CSV å­—ä¸²
          // join(',') æœƒç”¨é€—è™Ÿé€£æ¥é™£åˆ—å…ƒç´ 
          let csvContent = headers.join(",") + "\n";

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ3ã€‘é€ç­†åŠ å…¥è³‡æ–™
          // forEach è¿´åœˆæœƒå°æ¯ä¸€ç­†çµæœåŸ·è¡Œç›¸åŒæ“ä½œ
          this.results.forEach((result) => {
            const row = [
              result.participantId,
              result.phase,
              result.trial,
              result.rule,
              result.cardBackground,
              result.cardForeground,
              result.keyPressed,
              result.correctKey,
              result.isCorrect ? "TRUE" : "FALSE",
              result.reactionTime,
              result.timestamp,
            ];
            csvContent += row.join(",") + "\n";
          });

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ4ã€‘å»ºç«‹ Blob ç‰©ä»¶
          // Blob = Binary Large Objectï¼Œç”¨ä¾†è¡¨ç¤ºæª”æ¡ˆå…§å®¹
          // type: 'text/csv' å‘Šè¨´ç€è¦½å™¨é€™æ˜¯ CSV æ–‡å­—æª”
          // charset=utf-8 ç¢ºä¿ä¸­æ–‡æ­£ç¢ºé¡¯ç¤º
          const blob = new Blob([csvContent], {
            type: "text/csv;charset=utf-8;",
          });

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ5ã€‘å»ºç«‹ä¸‹è¼‰é€£çµ
          // URL.createObjectURL ç”¢ç”Ÿä¸€å€‹è‡¨æ™‚ç¶²å€æŒ‡å‘é€™å€‹æª”æ¡ˆ
          const url = URL.createObjectURL(blob);

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ6ã€‘å»ºç«‹éš±è—çš„ <a> æ¨™ç±¤
          const link = document.createElement("a");
          link.href = url;

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ7ã€‘è¨­å®šæª”æ¡ˆåç¨±
          // æ ¼å¼ï¼šDCCS_çµæœ_å—è©¦è€…ç·¨è™Ÿ_æ—¥æœŸæ™‚é–“.csv
          const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
          link.download = `DCCS_Results_${this.participantId}_${timestamp}.csv`;

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ8ã€‘è§¸ç™¼ä¸‹è¼‰
          document.body.appendChild(link); // åŠ åˆ°é é¢ï¼ˆå¿…é ˆï¼‰
          link.click(); // æ¨¡æ“¬é»æ“Š
          document.body.removeChild(link); // ç§»é™¤ï¼ˆæ¸…ç†ï¼‰

          // ã€æ•™å­¸èªªæ˜æ­¥é©Ÿ9ã€‘é‡‹æ”¾è¨˜æ†¶é«”
          // è‡¨æ™‚ç¶²å€ä½¿ç”¨å®Œç•¢å¾Œè¦é‡‹æ”¾ï¼Œé¿å…è¨˜æ†¶é«”æ´©æ¼
          URL.revokeObjectURL(url);

          console.log("âœ… è³‡æ–™åŒ¯å‡ºå®Œæˆ");
          alert("âœ… è³‡æ–™å·²ä¸‹è¼‰ï¼æª”æ¡ˆæ ¼å¼ç‚º CSVï¼Œå¯ç”¨ Excel æˆ–æ–‡å­—ç·¨è¼¯å™¨é–‹å•Ÿã€‚");
        },

        // ========================================================
        // é‡æ–°é–‹å§‹ (Restart)
        // æ•™å­¸èªªæ˜ï¼šé‡ç½®æ‰€æœ‰ç‹€æ…‹ï¼Œå›åˆ°é–‹å§‹ç•«é¢
        // ========================================================
        restart() {
          console.log("ğŸ”„ é‡æ–°é–‹å§‹éŠæˆ²");

          // é‡ç½®æ‰€æœ‰ç‹€æ…‹
          this.participantId = "";
          this.currentPhase = 0;
          this.currentTrial = 0;
          this.totalTrials = 0;
          this.currentCard = null;
          this.currentRule = "";
          this.results = [];

          // æ¸…ç©ºè¼¸å…¥æ¡†
          document.getElementById("participantId").value = "";

          // å›åˆ°é¦–é 
          this.showScreen("landingScreen");
        },

        // ========================================================
        // é¡¯ç¤ºç•«é¢ (Show Screen)
        // æ•™å­¸èªªæ˜ï¼šåˆ‡æ›é¡¯ç¤ºä¸åŒçš„ç•«é¢
        // ========================================================
        showScreen(screenId) {
          // éš±è—æ‰€æœ‰ç•«é¢
          const screens = document.querySelectorAll(".screen");
          screens.forEach((screen) => screen.classList.remove("active"));

          // é¡¯ç¤ºæŒ‡å®šç•«é¢
          document.getElementById(screenId).classList.add("active");

          console.log(`ğŸ“º åˆ‡æ›ç•«é¢: ${screenId}`);
        },
      };

      // ========================================================
      // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–éŠæˆ²
      // æ•™å­¸èªªæ˜ï¼šç¢ºä¿ HTML å®Œå…¨è¼‰å…¥å¾Œæ‰åŸ·è¡Œ JavaScript
      // ========================================================
      window.addEventListener("DOMContentLoaded", () => {
        game.init();
      });
    </script>
  </body>
</html>
